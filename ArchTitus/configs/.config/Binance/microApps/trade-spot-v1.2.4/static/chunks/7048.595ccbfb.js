(self["webpackJsonp_trade-spot"]=self["webpackJsonp_trade-spot"]||[]).push([[7048],{"0ZXH":(e,t,a)=>{"use strict";a.d(t,{Wg:()=>n});var r=a("H+/5"),o="lang";function n(e,t){void 0===e&&(e="en"),void 0===t&&(t=365),r.Q.erase(o),r.Q.write(o,e.toLowerCase(),t)}},Dowt:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a("5vwO"),o=a("/SIk"),n=a.n(o),l=a("opEY"),i=a("szIg"),s=a("vs24"),c=a("h+sK"),d=a("VDrE"),_=a("ErMs"),h=a("9mqn"),u=a("xRsZ"),g=a("ADYW"),m=a("LgBl"),k=a("WBfh"),v=a("3k2H"),p=a("Ozc/"),y=a("S24M"),E=a("/MJE"),b=a("lXyA"),S=a.n(b),C=a("sjyN");const T="trd_chart_basic_kline_load_timeout",D=e=>[e.time,e.open,e.high,e.low,e.close],A=({dataProvider:e,symbol:t,interval:a,logOnFetchEndCallback:n,logOnFetchStartCallback:l,logOnKlineReadyCallback:i,logOnErrorDataCallback:s,logOnCatchChartCallback:c})=>({logOnFetchEnd:(0,o.useCallback)((()=>{S()((()=>{(0,v.Os)({eventId:T,stepId:"fetchDataEnd",catch({error:e,track:t}){t({FETCH_DATA_END_TYPE:e}),t({type:`FETCH_DATA_END_TYPE_${e}`})},log({track:e}){e({FETCH_DATA_END_TYPE:"SUCCESS"})}})})),null===n||void 0===n||n()}),[n]),logOnFetchStart:(0,o.useCallback)((()=>{S()((()=>{const e=(0,v.Nb)({id:"fetchDataStart"}),t=(0,v.Nb)({id:"fetchDataEnd",timeout:6}),a=(0,v.Nb)({id:"basicKlineReady",timeout:3}),r=v.Nb.auto({log:({track:e})=>{e({type:"SUCCESS"})}});v.Os.init({step:e._(t)._(a)._(r),eventId:"trd_chart_basic_kline_load_timeout"}),(0,v.Os)({eventId:T,stepId:"fetchDataStart",catch({error:e,track:t}){t({FETCH_DATA_START_TYPE:e}),t({type:`FETCH_DATA_START_TYPE_${e}`})},log({track:e}){e({FETCH_DATA_START_TYPE:"SUCCESS"})}})})),null===l||void 0===l||l()}),[l]),logOnKlineReady:(0,o.useCallback)((()=>{S()((()=>{(0,v.Os)({eventId:T,stepId:"basicKlineReady",catch({error:e,track:t}){t({BASIC_KLINE_READY_TYPE:e}),t({type:`BASIC_KLINE_READY_TYPE_${e}`})},log({track:e}){e({BASIC_KLINE_READY_TYPE:"SUCCESS"})}})})),null===i||void 0===i||i()}),[i]),logOnErrorData:(0,C.D)((()=>{S()((o=>{var n,l;const i=null===e||void 0===e||null===(n=e.trackingData)||void 0===n?void 0:n.klineDataQueue.find((({id:e})=>o.payload.prevItem.id===e)),c=null===e||void 0===e||null===(l=e.trackingData)||void 0===l?void 0:l.klineDataQueue.find((({id:e})=>o.payload.nextItem.id===e));(0,y.j)(`trd_chart_${o.type}`,(0,r.Z)({trd_chart_symbol:t,trd_chart_interval:a,neighbor:JSON.stringify([i,c])},(e=>{switch(e.type){case"disConnect":case"renderError":return{trd_chart_nextItem:JSON.stringify(D(e.payload.nextItem)),trd_chart_prevItem:JSON.stringify(D(e.payload.prevItem))};case"invalidData":return{trd_chart_invalid_data:JSON.stringify(D(e.payload.data))};default:return{}}})(o))),null===s||void 0===s||s()}))})),logOnCatchChart:(0,o.useCallback)((e=>{p.Z.log(JSON.stringify({type:"kline-error",error:e}),"custom"),null===c||void 0===c||c()}),[c])});var f=n().createElement;const I=h.kM.map((({value:e})=>e)),O=({symbol:e,namespace:t,dataProvider:a,logOnFetchEndCallback:n,candleRef:d,isShowDrawPanel:p=!1,isShowAnnotationPanel:y=!0})=>{const b=(0,u.AM)()[e],{symbolDisplay:S="",baseAsset:C,quoteAsset:T,tickSize:D="0.01"}=b||{},O=(0,u.Fg)().isLight?"light":"dark",[w,N]=(0,g.TG)(),P=(0,u.C$)(),F=(0,i.useSelector)((e=>e.setting.layout)),{getI18n:M}=(0,h.K_)(),{0:Y,1:K}=(0,o.useState)(1),[R,H]=(0,m.Qy)(t)(k.St),[Z,B]=(0,m.Nu)(t)(k.At),J=(0,m.H9)(t)(k.Hs),L=(0,m.v5)(t)(k.B3),x=(0,o.useCallback)((e=>J===h.vm.basic&&L(e)),[J,L]),$=(0,m.mj)(t)(k.aK),z=(0,o.useMemo)((()=>(0,v.p8)(+D)),[D]),{setMessageInfo:j}=(0,u.YT)(),Q=(0,g.zE)((()=>{"1M"!==R&&K((e=>e+1))}),1e3),U=A({dataProvider:a,symbol:e,interval:R,logOnFetchEndCallback:n,logOnErrorDataCallback:Q}),q=(0,o.useMemo)((()=>(0,r.Z)({symbol:e,storeSymbol:e,interval:R,candlestick:{type:Z,tickSize:z,isFloor:!0},theme:O,themeKey:P,isShowDrawPanel:p,isShowAnnotationPanel:y,getI18n:M,baseAsset:C,quoteAsset:T,dataProvider:a,customTheme:{light:w,dark:N},setLoading:x,namespace:t,sensorsManager:U,onModalClose(e){(0,l.t)({event:"click",eventCategory:"td_spotnmargin",eventAction:"click",eventLabel:`td_spot_margin::select_chart_${e}`,layout:F,elementid:"chart-interval-modal-save-btn"})}},{isShowCustomIndicator:!0})),[e,R,Z,O,M,C,T,a,w,N,x,t,U,z,P,p,y,F]);return f(s.Z,{flex:1,sx:{position:"relative",overflow:"hidden",height:"100%",display:J!==h.vm.basic?"none":"block"},key:`${e}${Y}`,className:"focus-area"},f(_.k.BasicKline,{klineOptions:q,showIndicatorMenu:$,electronShortcutOptions:{symbol:e,options:I,value:Z===c.oX.Line?"Time":R,setInterval:H,setChartType:B,electron:E.Z,enabled:!0},userDefinedIndicatorOptions:{symbolDisplay:S.split("/").join("_"),bizType:"trade",setMessageInfo:j,electron:E.Z},ref:d}))},w=e=>{const{getI18n:t}=(0,u.ZK)(),a=(0,o.useMemo)((()=>t("trd-chart-crash-info",{defaultValue:"Something is wrong with the chart."})||""),[t]),r=(0,o.useMemo)((()=>t("trd-chart-crash-refresh",{defaultValue:"Refresh"})||""),[t]),n=(0,o.useCallback)(((e,t)=>{p.Z.log(JSON.stringify({type:"origin_kline",error:e,componentStack:t}),"custom")}),[]);return f(d.S,{name:"origin_kline",FallbackComponent:({resetErrorBoundary:e})=>f(_.k.ChartFallback,{mainText:a,btnText:r,resetErrorBoundary:e}),onError:n,track:y.j},f(O,e))},N=n().memo(w)}}]);