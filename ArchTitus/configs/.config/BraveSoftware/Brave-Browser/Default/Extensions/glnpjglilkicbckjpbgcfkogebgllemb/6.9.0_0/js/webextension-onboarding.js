Okta.Onboarding=function(n){var r={};var e=Okta.fn.bg.chromeP;var f=Okta.fn.url.hrefToUrlParts;var t=Okta.fn.script.injectOnboardingScript;var a=Okta.Q.allSettled;var i=Okta._okta;var o=i.each;var d=i.extend;var s=Okta.fn.cookies.getCookies;var u=Okta.Q;var v=i.filter;var c=i.find;var l=i.sortBy;var h=i.first;var m=i.map;var g=Okta.Q.defer;var b=new Okta.Tabs(n);function k(){return e.tabs.create({url:"https://login.okta.com",active:false}).then(function(e){var t=g();var a=function(n,r){if(n!=e.id){return}if(r.status&&r.status==="complete"){t.resolve(e.id);chrome.tabs.onUpdated.removeListener(a)}};chrome.tabs.onUpdated.addListener(a);return t.promise}).then(function(r){return t(r).then(function(n){b.closeTab(r);if(n&&n.length===1){return JSON.parse(n[0])}return[]})})}r.getOrgsWithSessionCookies=function(){var t=g();k().then(function(e){if(!e||e.length===0){t.resolve({oktaAccounts:[],sessions:[]});return}var u=[];var n=m(e,function(o){return s(o.origin+"/app/UserHome",["sid","DT","idx"]).then(function(n){var r=function(r){return c(n,function(n){return n.name===r})};var e=r("sid");var t=r("DT");var a=r("idx");if(e&&t||a){var i=o.origin;u.push({domain:i,sid:e&&e.value,dt:t&&t.value,idx:a&&a.value})}})});a(n).then(function(n){o(n,function(n){if(n.state!=="fulfilled"){Log.warn("WebExtension::getOrgsWithSessionCookies: Unable to fulfill getCookies: "+n.reason)}});if(u.length===0){t.resolve({oktaAccounts:e,sessions:[]});return}chrome.windows.getCurrent({},function(s){var n=m(u,function(n){return n.domain+"/*"});chrome.tabs.query({url:n},function(i){if(!i||i.length===0){t.resolve({oktaAccounts:e,sessions:u})}var o=function(n){var r=0;if(n.isDashboardTab){r-=100}if(n.isInCurrentWindow){r-=10}if(n.id!==undefined&&n.index!==undefined){r-=1}return r};var n=m(u,function(r){var n=v(i,function(n){return n.url.indexOf(r.domain)!==-1});if(!n||n.length===0){return r}var e=m(n,function(n){var r=f&&f(n.url);return d(n,{isDashboardTab:r&&r.path==="/app/UserHome",isInCurrentWindow:n.windowId===s.id})});var t=l(e,o);var a=h(t);return d(r,{tabId:a.id,tabIndex:a.index,isDashboardTab:a.isDashboardTab,isInCurrentWindow:a.isInCurrentWindow})});var r=l(n,o);t.resolve({oktaAccounts:e,sessions:r})})})})});return t.promise};r.isInstalledByUser=function(){if(!e.management.getSelf){return u(false)}return e.management.getSelf().then(function(n){var r=n&&n.installType;return r==="normal"||r==="development"})};r.setUninstallURL=function(n){chrome.runtime.setUninstallURL(n)};return r};